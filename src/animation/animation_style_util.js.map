{"version":3,"file":"animation_style_util.js","sourceRoot":"","sources":["../../../../../modules/@angular/core/src/animation/animation_style_util.ts"],"names":[],"mappings":"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","sourcesContent":["import {ListWrapper, StringMapWrapper} from '../facade/collection';\nimport {isArray, isPresent} from '../facade/lang';\n\nimport {FILL_STYLE_FLAG} from './animation_constants';\nimport {AUTO_STYLE} from './metadata';\n\nexport function balanceAnimationStyles(\n    previousStyles: {[key: string]: string | number}, newStyles: {[key: string]: string | number},\n    nullValue: any /** TODO #9100 */ = null): {[key: string]: string} {\n  var finalStyles: {[key: string]: string} = {};\n\n  StringMapWrapper.forEach(\n      newStyles, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n        finalStyles[prop] = value.toString();\n      });\n\n  StringMapWrapper.forEach(\n      previousStyles, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n        if (!isPresent(finalStyles[prop])) {\n          finalStyles[prop] = nullValue;\n        }\n      });\n\n  return finalStyles;\n}\n\nexport function balanceAnimationKeyframes(\n    collectedStyles: {[key: string]: string | number},\n    finalStateStyles: {[key: string]: string | number}, keyframes: any[]): any[] {\n  var limit = keyframes.length - 1;\n  var firstKeyframe = keyframes[0];\n\n  // phase 1: copy all the styles from the first keyframe into the lookup map\n  var flatenedFirstKeyframeStyles = flattenStyles(firstKeyframe.styles.styles);\n\n  var extraFirstKeyframeStyles = {};\n  var hasExtraFirstStyles = false;\n  StringMapWrapper.forEach(\n      collectedStyles, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n        // if the style is already defined in the first keyframe then\n        // we do not replace it.\n        if (!(flatenedFirstKeyframeStyles as any /** TODO #9100 */)[prop]) {\n          (flatenedFirstKeyframeStyles as any /** TODO #9100 */)[prop] = value;\n          (extraFirstKeyframeStyles as any /** TODO #9100 */)[prop] = value;\n          hasExtraFirstStyles = true;\n        }\n      });\n\n  var keyframeCollectedStyles = StringMapWrapper.merge({}, flatenedFirstKeyframeStyles);\n\n  // phase 2: normalize the final keyframe\n  var finalKeyframe = keyframes[limit];\n  ListWrapper.insert(finalKeyframe.styles.styles, 0, finalStateStyles);\n\n  var flatenedFinalKeyframeStyles = flattenStyles(finalKeyframe.styles.styles);\n  var extraFinalKeyframeStyles = {};\n  var hasExtraFinalStyles = false;\n  StringMapWrapper.forEach(\n      keyframeCollectedStyles, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n        if (!isPresent((flatenedFinalKeyframeStyles as any /** TODO #9100 */)[prop])) {\n          (extraFinalKeyframeStyles as any /** TODO #9100 */)[prop] = AUTO_STYLE;\n          hasExtraFinalStyles = true;\n        }\n      });\n\n  if (hasExtraFinalStyles) {\n    finalKeyframe.styles.styles.push(extraFinalKeyframeStyles);\n  }\n\n  StringMapWrapper.forEach(\n      flatenedFinalKeyframeStyles, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n        if (!isPresent((flatenedFirstKeyframeStyles as any /** TODO #9100 */)[prop])) {\n          (extraFirstKeyframeStyles as any /** TODO #9100 */)[prop] = AUTO_STYLE;\n          hasExtraFirstStyles = true;\n        }\n      });\n\n  if (hasExtraFirstStyles) {\n    firstKeyframe.styles.styles.push(extraFirstKeyframeStyles);\n  }\n\n  return keyframes;\n}\n\nexport function clearStyles(styles: {[key: string]: string | number}): {[key: string]: string} {\n  var finalStyles: {[key: string]: string} = {};\n  StringMapWrapper.keys(styles).forEach(key => { finalStyles[key] = null; });\n  return finalStyles;\n}\n\nexport function collectAndResolveStyles(\n    collection: {[key: string]: string | number}, styles: {[key: string]: string | number}[]) {\n  return styles.map(entry => {\n    var stylesObj = {};\n    StringMapWrapper.forEach(entry, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n      if (value == FILL_STYLE_FLAG) {\n        value = collection[prop];\n        if (!isPresent(value)) {\n          value = AUTO_STYLE;\n        }\n      }\n      collection[prop] = value;\n      (stylesObj as any /** TODO #9100 */)[prop] = value;\n    });\n    return stylesObj;\n  });\n}\n\nexport function renderStyles(\n    element: any, renderer: any, styles: {[key: string]: string | number}): void {\n  StringMapWrapper.forEach(styles, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n    renderer.setElementStyle(element, prop, value);\n  });\n}\n\nexport function flattenStyles(styles: {[key: string]: string | number}[]) {\n  var finalStyles = {};\n  styles.forEach(entry => {\n    StringMapWrapper.forEach(entry, (value: any /** TODO #9100 */, prop: any /** TODO #9100 */) => {\n      (finalStyles as any /** TODO #9100 */)[prop] = value;\n    });\n  });\n  return finalStyles;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}