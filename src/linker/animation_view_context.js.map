{"version":3,"file":"animation_view_context.js","sourceRoot":"","sources":["../../../../../modules/@angular/core/src/linker/animation_view_context.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimationGroupPlayer} from '../animation/animation_group_player';\nimport {AnimationPlayer} from '../animation/animation_player';\nimport {queueAnimation as queueAnimationGlobally} from '../animation/animation_queue';\nimport {AnimationTransitionEvent} from '../animation/animation_transition_event';\nimport {ViewAnimationMap} from '../animation/view_animation_map';\n\nexport class AnimationViewContext {\n  private _players = new ViewAnimationMap();\n  private _listeners = new Map<any, _AnimationOutputHandler[]>();\n\n  onAllActiveAnimationsDone(callback: () => any): void {\n    var activeAnimationPlayers = this._players.getAllPlayers();\n    // we check for the length to avoid having GroupAnimationPlayer\n    // issue an unnecessary microtask when zero players are passed in\n    if (activeAnimationPlayers.length) {\n      new AnimationGroupPlayer(activeAnimationPlayers).onDone(() => callback());\n    } else {\n      callback();\n    }\n  }\n\n  queueAnimation(\n      element: any, animationName: string, player: AnimationPlayer,\n      event: AnimationTransitionEvent): void {\n    queueAnimationGlobally(player);\n\n    this._players.set(element, animationName, player);\n    player.onDone(() => {\n      // TODO: add codegen to remove the need to store these values\n      this._triggerOutputHandler(element, animationName, 'done', event);\n      this._players.remove(element, animationName);\n    });\n\n    player.onStart(() => this._triggerOutputHandler(element, animationName, 'start', event));\n  }\n\n  cancelActiveAnimation(element: any, animationName: string, removeAllAnimations: boolean = false):\n      void {\n    if (removeAllAnimations) {\n      this._players.findAllPlayersByElement(element).forEach(player => player.destroy());\n    } else {\n      var player = this._players.find(element, animationName);\n      if (player) {\n        player.destroy();\n      }\n    }\n  }\n\n  registerOutputHandler(\n      element: any, eventName: string, eventPhase: string, eventHandler: Function): void {\n    var animations = this._listeners.get(element);\n    if (!animations) {\n      this._listeners.set(element, animations = []);\n    }\n    animations.push(new _AnimationOutputHandler(eventName, eventPhase, eventHandler));\n  }\n\n  private _triggerOutputHandler(\n      element: any, animationName: string, phase: string, event: AnimationTransitionEvent): void {\n    const listeners = this._listeners.get(element);\n    if (listeners && listeners.length) {\n      for (let i = 0; i < listeners.length; i++) {\n        let listener = listeners[i];\n        // we check for both the name in addition to the phase in the event\n        // that there may be more than one @trigger on the same element\n        if (listener.eventName === animationName && listener.eventPhase === phase) {\n          listener.handler(event);\n          break;\n        }\n      }\n    }\n  }\n}\n\nclass _AnimationOutputHandler {\n  constructor(public eventName: string, public eventPhase: string, public handler: Function) {}\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}